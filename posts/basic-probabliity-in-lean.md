---
author: 'Rémy Degenne'
category: 'Tutorial'
date: 2024-10-02 16:41:48 UTC+02:00
description: ''
has_math: true
link: ''
slug: basic-probability-in-lean
tags: ''
title: Basic probability in Lean
type: text
---

How do I define a probability space and two independent random variables in Lean? Should I use `IsProbabilityMeasure` or `ProbabilityMeasure`?
How do I condition on an event?

This post answers these and other simple questions about how to express probability concepts using Mathlib.

<!-- TEASER_END -->

The code examples will mostly not mention imports: use `import Mathlib` in a project that depends on Mathlib (and then prune the imports with `#min_imports` if you like).

# Probability spaces and probability measures

First, in order to work on probability we need a measurable space.
We can define a probability measure on such a space as follows.
```lean
variable {Ω : Type*} [MeasurableSpace Ω] {P : Measure Ω} [IsProbabilityMeasure P]
```
The class `MeasurableSpace Ω` defines a sigma-algebra on `Ω`. We then introduced a measure `P` and specified that it should be a probability measure.
If we want to work on `ℝ` the typeclass inference system will find `[MeasurableSpace ℝ]` on its own. We can write simply
```lean
variable {P : Measure ℝ} [IsProbabilityMeasure P]
```

With the code above, we can introduce several probability measures on the same space. When using lemmas and definitions about those measures, we will need to specify which measure we are talking about.
```lean
TODO example
```
But perhaps we just want a space with a canonical probability measure, which would ideally be the one used without us having to tell Lean.
That can be done with the `MeasureSpace` class. A `MeasureSpace` is a `MeasurableSpace` with a canonical measure, called `volume`.
The probability library of Mathlib defines a notation `TODO P` for that measure. We still need to tell that we want it to be a probability measure though.
```lean
variable {Ω : Type*} [MeasureSpace Ω] [IsProbabilityMeasure (TODO P : Measure Ω)]
```
Note: in the code above we can't write only `[IsProbabilityMeasure TODO P]` because Lean would then not know to which space the default measure `TODO P` refers to.
That will not be necessary when we use `TODO P` in proofs because the context will be enough to infer `Ω`.

# Probability of events

A `Measure` can be applied to a set like a function, and returns a value in `ENNReal` (denoted by the notation `ℝ≥0∞`, available after `open scoped ENNReal`).
```lean
import Mathlib
open scoped ENNReal

example (P : Measure ℝ) (s : Set ℝ) : ℝ≥0∞ := P s
```
The type `ℝ≥0∞` represents the nonnegative reals and infinity: the measure of a set is a nonnegative real number which in general may be infinite.

TODO: `MeasurableSet`

TODO: `.of_discrete`, `[DiscreteMeasurableSpace]`

TODO: `simp` knows `measure_ne_top`

# Random variables

A random variable is a measurable function from a measurable space to another.
```lean
variable {Ω : Type*} [MeasurableSpace Ω] {X : Ω → ℝ} (hX : Measurable X)
```
In that code we defined a random variable `X` from the measurable space `Ω` to `ℝ` (for which the typeclass inference system finds a measurable space instance). `hX` states that `X` is measurable, which is necessary for most manipulations TODO.

# Additional typeclasses on measurable spaces

Some results in probability theory require the sigma-algebra to be the Borel sigma-algebra, generated by the open sets.
For that we first need `Ω` to be a topological space and we then need to add a `[BorelSpace Ω]` variable, which links topology and measurability.
```lean
variable {Ω : Type*} [MeasurableSpace Ω] [TopologicalSpace Ω] [BorelSpace Ω]
```



TODO: `ProbabilityMeasure`

# Additional resources


